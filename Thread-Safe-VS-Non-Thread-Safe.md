# **Thread Safe (TS)** และ **Non Thread Safe (NTS)**

ในการเลือกดาวน์โหลด PHP สำหรับ Windows คุณจะเห็นตัวเลือก **Thread Safe (TS)** และ **Non Thread Safe (NTS)** เสมอ ซึ่งความแตกต่างนี้สำคัญมากต่อประสิทธิภาพและความเสถียรของเซิร์ฟเวอร์ครับ

---

## 1. Thread Safe (TS)

**Thread Safe** คือ PHP เวอร์ชันที่ถูกออกแบบมาให้ทำงานในสภาพแวดล้อมที่มีการจัดการแบบ **Multi-threading** (การทำงานหลายงานย่อยพร้อมกันใน Processor เดียวกัน)

* **หลักการทำงาน:** มีกลไกที่เรียกว่า **TSRM (Thread Safe Resource Monitor)** เพื่อคอยเช็กว่าข้อมูลที่ Thread หนึ่งกำลังใช้งานอยู่ จะไม่ถูก Thread อื่นเข้ามาเขียนทับจนรวน
* **เหมาะสำหรับ:** การใช้ PHP เป็น Module ร่วมกับ Web Server อย่าง **Apache** (ผ่าน `mod_php`) ซึ่ง Apache จะสร้าง Thread ขึ้นมาจัดการ Request หลายๆ อย่างพร้อมกัน

## 2. Non Thread Safe (NTS)

**Non Thread Safe** คือ PHP เวอร์ชันที่ "ตัด" กลไกการตรวจสอบความปลอดภัยของ Thread ออกไป เพื่อลดความซับซ้อนและเพิ่มความเร็ว

* **หลักการทำงาน:** ไม่มีการเช็กความปลอดภัยของ Thread ทำให้ประมวลผลได้เร็วกว่า (เพราะไม่ต้องมี Overhead ของ TSRM) แต่จะทำงานได้ทีละหนึ่ง Process ต่อหนึ่งงานเท่านั้น
* **เหมาะสำหรับ:** การใช้งานผ่าน **FastCGI** (เช่นบน **IIS** ของ Windows หรือ **Nginx**) และการรันผ่าน Command Line (CLI) เพราะ Web Server เหล่านี้จะแยก Process ออกจากกันโดยเด็ดขาดอยู่แล้ว

---

## สรุปความแตกต่าง

| คุณสมบัติ | Thread Safe (TS) | Non Thread Safe (NTS) |
| --- | --- | --- |
| **ความเร็ว** | ช้ากว่าเล็กน้อย (เพราะมีระบบเช็ก Thread) | **เร็วกว่า** |
| **ความเสถียร** | สูงในระบบ Multi-thread | สูงในระบบ Multi-process |
| **การใช้งานหลัก** | Apache (mod_php) | **IIS**, **Nginx**, **FastCGI** |
| **ไฟล์ที่ใช้เรียก** | `php8ts.dll` | `php8nts.dll` |

---

### ควรเลือกใช้อันไหนดี?

* **ถ้าคุณใช้ Apache:** ส่วนใหญ่จะแนะนำให้โหลดแบบ **Thread Safe**
* **ถ้าคุณใช้ IIS (Windows Server):** ต้องเลือก **Non Thread Safe** เท่านั้น เพราะ IIS ทำงานผ่าน FastCGI ซึ่ง NTS จะให้ประสิทธิภาพที่ดีกว่ามาก
* **ถ้าคุณใช้ XAMPP / WampServer:** ปกติแพ็กเกจเหล่านี้จะติดตั้งแบบ **Thread Safe** มาให้เรียบร้อยแล้วครับ
